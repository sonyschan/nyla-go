<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Community Sections i18n Comprehensive Test</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: #1a1a1a; 
            color: white; 
            max-width: 900px;
            margin: 0 auto;
        }
        .test-section { 
            margin: 20px 0; 
            padding: 15px; 
            border: 1px solid #333; 
            border-radius: 8px; 
        }
        .test-button { 
            background: #FF6B35; 
            color: white; 
            border: none; 
            padding: 12px 20px; 
            margin: 8px; 
            border-radius: 6px; 
            cursor: pointer; 
            font-size: 16px;
        }
        .test-button:hover { background: #e55a2b; }
        .success { color: #4CAF50; }
        .error { color: #f44336; }
        .test-result { 
            margin: 10px 0; 
            padding: 10px; 
            background: #2a2a2a; 
            border-radius: 4px; 
        }
        .current-lang {
            background: #FF6B35;
            padding: 8px 15px;
            border-radius: 6px;
            font-weight: bold;
        }
        .demo-group {
            background: #2a2a2a;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #FF6B35;
        }
        .demo-item {
            padding: 8px;
            margin: 5px 0;
            background: #333;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .key-label {
            font-family: 'Courier New', monospace;
            font-size: 11px;
            color: #888;
        }
        .translation-text {
            color: #FFD700;
            font-weight: bold;
        }
        h3 { 
            color: #FF6B35; 
            margin-top: 0;
        }
        .section-title {
            color: #4CAF50;
            font-size: 18px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <h1>üèõÔ∏è Community Sections i18n Test</h1>
    <p>Testing all Community Raids, Apps, and Settings translations</p>
    
    <div class="test-section">
        <h2>Language Control</h2>
        <div style="margin-bottom: 15px;">
            Current: <span id="currentLang" class="current-lang">Loading...</span>
        </div>
        <button class="test-button" onclick="setEnglish()">English</button>
        <button class="test-button" onclick="setChinese()">‰∏≠Êñá</button>
        <button class="test-button" onclick="updateAllCommunityTranslations()">Update All Community Translations</button>
        <div id="initStatus" class="test-result">Initializing...</div>
    </div>
    
    <div class="test-section">
        <h2>üéØ Community Raids Translations</h2>
        
        <div class="demo-group">
            <div class="section-title">Main Headers</div>
            <div class="demo-item">
                <div>
                    <strong>Back Button:</strong><br>
                    <span class="key-label">ui.back</span>
                </div>
                <div id="raidBack" class="translation-text">Loading...</div>
            </div>
            <div class="demo-item">
                <div>
                    <strong>Title:</strong><br>
                    <span class="key-label">raids.title</span>
                </div>
                <div id="raidTitle" class="translation-text">Loading...</div>
            </div>
            <div class="demo-item">
                <div>
                    <strong>Subtitle:</strong><br>
                    <span class="key-label">raids.subtitle</span>
                </div>
                <div id="raidSubtitle" class="translation-text">Loading...</div>
            </div>
        </div>
        
        <div class="demo-group">
            <div class="section-title">Category Content (from shared data)</div>
            <div class="demo-item">
                <div>
                    <strong>NYLA Core:</strong><br>
                    <span class="key-label">ext.raids.core.title</span>
                </div>
                <div id="raidCoreTitle" class="translation-text">Loading...</div>
            </div>
            <div class="demo-item">
                <div>
                    <strong>The Team:</strong><br>
                    <span class="key-label">ext.raids.team.title</span>
                </div>
                <div id="raidTeamTitle" class="translation-text">Loading...</div>
            </div>
            <div class="demo-item">
                <div>
                    <strong>Team Description:</strong><br>
                    <span class="key-label">ext.raids.team.description</span>
                </div>
                <div id="raidTeamDesc" class="translation-text">Loading...</div>
            </div>
            <div class="demo-item">
                <div>
                    <strong>Active Raiders:</strong><br>
                    <span class="key-label">ext.raids.active.title</span>
                </div>
                <div id="raidActiveTitle" class="translation-text">Loading...</div>
            </div>
            <div class="demo-item">
                <div>
                    <strong>Raiders Description:</strong><br>
                    <span class="key-label">ext.raids.active.description</span>
                </div>
                <div id="raidActiveDesc" class="translation-text">Loading...</div>
            </div>
            <div class="demo-item">
                <div>
                    <strong>Ticker Mentioned:</strong><br>
                    <span class="key-label">ext.raids.ticker.title</span>
                </div>
                <div id="raidTickerTitle" class="translation-text">Loading...</div>
            </div>
            <div class="demo-item">
                <div>
                    <strong>Ticker Description:</strong><br>
                    <span class="key-label">ext.raids.ticker.description</span>
                </div>
                <div id="raidTickerDesc" class="translation-text">Loading...</div>
            </div>
        </div>
    </div>
    
    <div class="test-section">
        <h2>üöÄ Community Apps Translations</h2>
        
        <div class="demo-group">
            <div class="section-title">Main Content</div>
            <div class="demo-item">
                <div>
                    <strong>Back Button:</strong><br>
                    <span class="key-label">ui.back</span>
                </div>
                <div id="appBack" class="translation-text">Loading...</div>
            </div>
            <div class="demo-item">
                <div>
                    <strong>Title:</strong><br>
                    <span class="key-label">apps.title</span>
                </div>
                <div id="appTitle" class="translation-text">Loading...</div>
            </div>
            <div class="demo-item">
                <div>
                    <strong>Subtitle:</strong><br>
                    <span class="key-label">apps.subtitle</span>
                </div>
                <div id="appSubtitle" class="translation-text">Loading...</div>
            </div>
            <div class="demo-item">
                <div>
                    <strong>Ecosystem Category:</strong><br>
                    <span class="key-label">apps.ecosystem.title</span>
                </div>
                <div id="appEcosystem" class="translation-text">Loading...</div>
            </div>
            <div class="demo-item">
                <div>
                    <strong>Gaming Category:</strong><br>
                    <span class="key-label">apps.gaming.title</span>
                </div>
                <div id="appGaming" class="translation-text">Loading...</div>
            </div>
        </div>
    </div>
    
    <div class="test-section">
        <h2>‚öôÔ∏è Settings Translations</h2>
        
        <div class="demo-group">
            <div class="section-title">Settings Content</div>
            <div class="demo-item">
                <div>
                    <strong>Back Button:</strong><br>
                    <span class="key-label">ui.back</span>
                </div>
                <div id="settingsBack" class="translation-text">Loading...</div>
            </div>
            <div class="demo-item">
                <div>
                    <strong>Title:</strong><br>
                    <span class="key-label">settings.title</span>
                </div>
                <div id="settingsTitle" class="translation-text">Loading...</div>
            </div>
            <div class="demo-item">
                <div>
                    <strong>Username Label:</strong><br>
                    <span class="key-label">settings.username</span>
                </div>
                <div id="settingsUsername" class="translation-text">Loading...</div>
            </div>
            <div class="demo-item">
                <div>
                    <strong>Language Label:</strong><br>
                    <span class="key-label">settings.language</span>
                </div>
                <div id="settingsLanguage" class="translation-text">Loading...</div>
            </div>
            <div class="demo-item">
                <div>
                    <strong>Username Help:</strong><br>
                    <span class="key-label">settings.username_help</span>
                </div>
                <div id="settingsUsernameHelp" class="translation-text">Loading...</div>
            </div>
        </div>
    </div>
    
    <div class="test-section">
        <h2>üìä Test Results</h2>
        <div id="testResults" class="test-result">
            <p><strong>Instructions:</strong></p>
            <ol>
                <li>Click language buttons to switch between English and Chinese</li>
                <li>Click "Update All Community Translations" to see the results</li>
                <li>All text should change when switching languages</li>
                <li>Verify that Community Raids, Apps, and Settings all translate properly</li>
            </ol>
        </div>
    </div>

    <script src="extension-i18n-next.js"></script>
    <script>
        let i18n = null;
        
        // Mock Chrome storage
        window.chrome = window.chrome || {
            storage: {
                sync: {
                    set: (data, cb) => {
                        Object.keys(data).forEach(k => localStorage.setItem('test_' + k, data[k]));
                        if (cb) cb();
                    },
                    get: (keys, cb) => {
                        const result = {};
                        const keysList = Array.isArray(keys) ? keys : [keys];
                        keysList.forEach(k => {
                            const val = localStorage.getItem('test_' + k);
                            if (val) result[k] = val;
                        });
                        cb(result);
                    }
                }
            }
        };
        
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                if (window.getExtensionI18n) {
                    i18n = window.getExtensionI18n();
                } else {
                    i18n = new ExtensionI18nNext();
                }
                
                await i18n.initialize();
                updateDisplay();
                document.getElementById('initStatus').innerHTML = '<span class="success">‚úÖ Ready! All community i18n keys loaded.</span>';
            } catch (e) {
                document.getElementById('initStatus').innerHTML = '<span class="error">‚ùå Error: ' + e.message + '</span>';
            }
        });
        
        function setEnglish() {
            if (i18n) {
                i18n.changeLanguage('en').then(updateDisplay);
            }
        }
        
        function setChinese() {
            if (i18n) {
                i18n.changeLanguage('zh').then(updateDisplay);
            }
        }
        
        function updateDisplay() {
            if (!i18n) return;
            
            const lang = i18n.getCurrentLanguage();
            document.getElementById('currentLang').textContent = lang === 'zh' ? '‰∏≠Êñá' : 'English';
            
            updateAllCommunityTranslations();
        }
        
        function updateAllCommunityTranslations() {
            if (!i18n) {
                document.getElementById('testResults').innerHTML = '<span class="error">‚ùå i18n not initialized</span>';
                return;
            }
            
            try {
                // Community Raids translations
                document.getElementById('raidBack').textContent = i18n.t('ui.back');
                document.getElementById('raidTitle').textContent = i18n.t('raids.title');
                document.getElementById('raidSubtitle').textContent = i18n.t('raids.subtitle');
                document.getElementById('raidCoreTitle').textContent = i18n.t('ext.raids.core.title');
                document.getElementById('raidTeamTitle').textContent = i18n.t('ext.raids.team.title');
                document.getElementById('raidTeamDesc').textContent = i18n.t('ext.raids.team.description');
                document.getElementById('raidActiveTitle').textContent = i18n.t('ext.raids.active.title');
                document.getElementById('raidActiveDesc').textContent = i18n.t('ext.raids.active.description');
                document.getElementById('raidTickerTitle').textContent = i18n.t('ext.raids.ticker.title');
                document.getElementById('raidTickerDesc').textContent = i18n.t('ext.raids.ticker.description');
                
                // Community Apps translations
                document.getElementById('appBack').textContent = i18n.t('ui.back');
                document.getElementById('appTitle').textContent = i18n.t('apps.title');
                document.getElementById('appSubtitle').textContent = i18n.t('apps.subtitle');
                document.getElementById('appEcosystem').textContent = i18n.t('apps.ecosystem.title');
                document.getElementById('appGaming').textContent = i18n.t('apps.gaming.title');
                
                // Settings translations
                document.getElementById('settingsBack').textContent = i18n.t('ui.back');
                document.getElementById('settingsTitle').textContent = i18n.t('settings.title');
                document.getElementById('settingsUsername').textContent = i18n.t('settings.username');
                document.getElementById('settingsLanguage').textContent = i18n.t('settings.language');
                document.getElementById('settingsUsernameHelp').textContent = i18n.t('settings.username_help');
                
                // Test results
                const lang = i18n.getCurrentLanguage();
                const results = [
                    `<p><span class="success">‚úÖ All community translations updated successfully!</span></p>`,
                    `<p><strong>Current Language:</strong> ${lang === 'zh' ? '‰∏≠Êñá (Chinese)' : 'English'}</p>`,
                    `<p><strong>Community Raids:</strong> 10 translation keys working</p>`,
                    `<p><strong>Community Apps:</strong> 5 translation keys working</p>`,
                    `<p><strong>Settings:</strong> 5 translation keys working</p>`,
                    `<p><strong>Total:</strong> 20+ community translation keys added and working ‚úÖ</p>`,
                    `<p><strong>Status:</strong> All Community sections now have full i18n support!</p>`
                ];
                
                document.getElementById('testResults').innerHTML = results.join('');
                
            } catch (error) {
                console.error('Translation error:', error);
                document.getElementById('testResults').innerHTML = 
                    `<span class="error">‚ùå Translation error: ${error.message}</span>`;
            }
        }
    </script>
</body>
</html>